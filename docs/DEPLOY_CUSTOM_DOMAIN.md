# Кастомный домен на Vercel — если не грузятся стили/скрипты

Если на **рабочем** домене (например `*.vercel.app`) всё открывается, а на **кастомном** (например .рф) — стили/скрипты грузятся плохо или не грузятся, задайте в Vercel переменную **NEXT_PUBLIC_SITE_URL** и пересоберите проект.

## Быстрое решение (домен .рф)

1. В Vercel: проект → **Settings** → **Environment Variables**.
2. Добавьте:
   - **Name:** `NEXT_PUBLIC_SITE_URL`
   - **Value:** `https://свадьба-в-усадьбе-ушмор.рф` (без слэша в конце, именно ваш домен)
   - Окружение: **Production** (и при необходимости Preview).
3. Сохраните и сделайте **Redeploy** (Deployments → … у последнего деплоя → Redeploy).

После сборки стили и скрипты будут запрашиваться с этого домена, что обычно устраняет проблемы с загрузкой на .рф.

---

Если после этого ресурсы всё равно не грузятся, проверьте пункты ниже.

## 1. Куда реально ведёт кастомный домен

Кастомный домен должен обслуживаться **тем же Vercel-проектом**. Иначе браузер получает HTML с одного места, а запросы к `/_next/static/...` уходят не туда и падают с 404 или не доходят.

- В **Vercel**: Project → **Settings** → **Domains** — там должен быть ваш кастомный домен (например `усадьба-на-пре.рф` или punycode `xn------5cdacdecesgo3h4a6abi1bg9h6cj.xn--p1ai`).
- В **DNS** у регистратора домена:
  - либо **CNAME** запись на значение, которое показывает Vercel для этого домена (часто `cname.vercel-dns.com`),  
  - либо **A**-записи на IP, которые указаны в настройках домена в Vercel.

Если кастомный домен указывает на **другой сервер** (свой хостинг, прокси, CDN), а не на Vercel, то этот сервер должен **проксировать все пути** (включая `/_next/*` и `/static/*`) на ваш Vercel-деплой. Иначе ассеты с кастомного домена грузиться не будут.

## 2. Что проверить в браузере

На странице кастомного домена откройте **Инструменты разработчика** (F12) → вкладка **Сеть (Network)**. Обновите страницу и посмотрите:

- Запросы к `/_next/static/...` — с какого URL идут (должен быть ваш кастомный домен) и какой ответ (200, 404, CORS и т.п.).
- Если в столбце «Запрос» виден **другой хост** (например `xxx.vercel.app`) — значит, HTML отдаётся с кастомного домена, а ассеты подставляются с другого; тогда стоит проверить, не задан ли где-то `assetPrefix` или базовый URL под другой домен.
- Если запросы к `/_next/static/...` идут на кастомный домен, но приходят **404** — запросы до Vercel не доходят (прокси/хостинг режет пути или отдаёт не тот проект).

## 3. Что сделано в проекте

- В `next.config.ts` **нет** `assetPrefix` — скрипты и стили запрашиваются по **относительным** путям с того же домена, с которого открыта страница.
- Для SEO и шаринга задайте в Vercel переменную **NEXT_PUBLIC_SITE_URL** = `https://ваш-кастомный-домен` (без слэша в конце).

После правок DNS или прокси подождите 5–15 минут и сделайте жёсткое обновление страницы (Ctrl+F5 / Cmd+Shift+R).
